library(DT)
# Interfaz de usuario
ui <- fluidPage(
titlePanel("Shiny App con Interacciones en Gráfico y Tabla"),
sidebarLayout(
sidebarPanel(
h4("Interacciones con el gráfico mtcars")
),
mainPanel(
plotOutput("scatterPlot",
hover = hoverOpts(id = "plot_hover", delay = 100, delayType = "throttle"),
click = "plot_click",
dblclick = "plot_dblclick",
brush = brushOpts(id = "plot_brush")),
DTOutput("table")
)
)
)
# Servidor
server <- function(input, output, session) {
# Crear una copia del dataset con una columna de color
mtcars_data <- reactiveVal(data.frame(mtcars, color = 'black', row.names = NULL))
# Renderizar el gráfico de dispersión
output$scatterPlot <- renderPlot({
data <- mtcars_data()
ggplot(data, aes(x = wt, y = mpg)) +
geom_point(aes(color = color), size = 3) +
scale_color_identity() +
theme_minimal() +
labs(x = "Peso (wt)", y = "Millas por galón (mpg)")
})
# Cambiar el color al hacer hover
observeEvent(input$plot_hover, {
hover <- input$plot_hover
data <- mtcars_data()
if (!is.null(hover)) {
hover_point <- nearPoints(data, hover, threshold = 10, maxpoints = 1)
if (nrow(hover_point) == 1) {
data$color[which(rownames(mtcars) == hover_point$row.names)] <- "gray"
mtcars_data(data)
}
}
}, ignoreInit = TRUE)
# Cambiar el color al hacer click
observeEvent(input$plot_click, {
click <- input$plot_click
data <- mtcars_data()
if (!is.null(click)) {
click_point <- nearPoints(data, click, threshold = 10, maxpoints = 1)
if (nrow(click_point) == 1) {
data$color[which(rownames(mtcars) == click_point$row.names)] <- "green"
mtcars_data(data)
}
}
})
# Restaurar el color al hacer doble click
observeEvent(input$plot_dblclick, {
dblclick <- input$plot_dblclick
data <- mtcars_data()
if (!is.null(dblclick)) {
dblclick_point <- nearPoints(data, dblclick, threshold = 10, maxpoints = 1)
if (nrow(dblclick_point) == 1) {
data$color[which(rownames(mtcars) == dblclick_point$row.names)] <- "blue"
mtcars_data(data)
}
}
})
# Cambiar el color de los puntos dentro del área de brush
observeEvent(input$plot_brush, {
brush <- input$plot_brush
data <- mtcars_data()
if (!is.null(brush)) {
brushed_points <- brushedPoints(data, brush)
if (nrow(brushed_points) > 0) {
data$color[which(rownames(mtcars) %in% brushed_points$row.names)] <- "orange"
mtcars_data(data)
}
}
})
# Renderizar la tabla interactiva
output$table <- renderDT({
datatable(mtcars_data(), options = list(pageLength = 10))
})
}
# Ejecutar la aplicación
shinyApp(ui = ui, server = server)
library(shiny)
library(ggplot2)
library(DT)
ui <- fluidPage(
titlePanel("Interacción con ggplot y mtcars"),
# Gráfico interactivo
plotOutput("plot",
hover = hoverOpts("plot_hover"),
click = clickOpts("plot_click"),
dblclick = dblclickOpts("plot_dblclick"),
brush = brushOpts("plot_brush", resetOnNew = TRUE)),
# Tabla interactiva
DTOutput("mtcars_table")
)
server <- function(input, output, session) {
# Estado inicial: todos los puntos sin color
vals <- reactiveValues(df = mtcars, color = rep("black", nrow(mtcars)))
# Gráfico ggplot
output$plot <- renderPlot({
ggplot(vals$df, aes(x = wt, y = mpg)) +
geom_point(aes(color = vals$color), size = 4) +
theme_minimal() +
scale_color_identity()
})
# Hover: Cambiar color a gris temporalmente
observeEvent(input$plot_hover, {
hover_index <- nearPoints(vals$df, input$plot_hover, allRows = TRUE)$selected_
vals$color[hover_index] <- "grey"
isolate(vals$color[!hover_index] <- "black")
})
# Click: Cambiar color a verde
observeEvent(input$plot_click, {
click_index <- nearPoints(vals$df, input$plot_click, allRows = TRUE)$selected_
vals$color[click_index] <- "green"
})
# Doble click: Quitar color (volver al estado inicial)
observeEvent(input$plot_dblclick, {
vals$color <- rep("black", nrow(vals$df))
})
# Brush: Cambiar color de los puntos seleccionados en el área de selección
observeEvent(input$plot_brush, {
brush_index <- brushedPoints(vals$df, input$plot_brush, allRows = TRUE)$selected_
vals$color[brush_index] <- "blue"
isolate(vals$color[!brush_index] <- "black")
})
# Mostrar tabla con librería DT
output$mtcars_table <- renderDT({
datatable(mtcars)
})
}
# Ejecutar la app Shiny
shinyApp(ui = ui, server = server)
library(shiny)
library(ggplot2)
library(DT)
ui <- fluidPage(
titlePanel("Interacción con ggplot y mtcars"),
# Gráfico interactivo
plotOutput("plot",
hover = hoverOpts("plot_hover"),
click = clickOpts("plot_click"),
dblclick = dblclickOpts("plot_dblclick"),
brush = brushOpts("plot_brush", resetOnNew = TRUE)),
# Tabla interactiva
DTOutput("mtcars_table")
)
server <- function(input, output, session) {
# Estado inicial: todos los puntos sin color
vals <- reactiveValues(df = mtcars, color = rep("black", nrow(mtcars)))
# Grafico ggplot
output$plot <- renderPlot({
ggplot(vals$df, aes(x = wt, y = mpg)) +
geom_point(aes(color = vals$color), size = 4) +
theme_minimal() +
scale_color_identity()
})
# On hover cambie el color a gris
observeEvent(input$plot_hover, {
hover_index <- nearPoints(vals$df, input$plot_hover, allRows = TRUE)$selected_
vals$color[hover_index] <- "grey"
isolate(vals$color[!hover_index] <- "black")
})
# On click cambie el color a verde
observeEvent(input$plot_click, {
click_index <- nearPoints(vals$df, input$plot_click, allRows = TRUE)$selected_
vals$color[click_index] <- "green"
})
# On doble click quite el color
observeEvent(input$plot_dblclick, {
vals$color <- rep("white", nrow(vals$df))
})
# On brush cambie el color a los puntos que están dentro del rectángulo.
observeEvent(input$plot_brush, {
brush_index <- brushedPoints(vals$df, input$plot_brush, allRows = TRUE)$selected_
vals$color[brush_index] <- "blue"
isolate(vals$color[!brush_index] <- "black")
})
output$mtcars_table <- renderDT({
datatable(mtcars)
})
}
# Ejecutar la app Shiny
shinyApp(ui = ui, server = server)
runApp('C:/Users/barri/Documents/UFM/2024/Segundo Semestre/Data Product/Tarea Shiny Plot/Tarea Shiny.R')
install.packages("markdown")
runApp('C:/Users/barri/Documents/UFM/2024/Segundo Semestre/Data Product/Tarea Shiny Plot/Tarea Shiny.R')
runApp('C:/Users/barri/Documents/UFM/2024/Segundo Semestre/Data Product/Tarea Shiny Plot/Tarea Shiny.R')
runApp('C:/Users/barri/Documents/UFM/2024/Segundo Semestre/Data Product/Tarea Shiny Plot/Tarea Shiny.R')
shiny::runApp('C:/Users/barri/Documents/UFM/2024/Segundo Semestre/Data Product/Tarea Shiny Plot/Shiny')
raw_longer <- raw_longer %>%
mutate(age = factor(recode(str_sub(raw_longer$column, start = 2),
"014" = "0-14",
"1524" = "15-24",
"2534" = "25-34",
"3544" = "35-44",
"4554" = "45-54",
"5564" = "55-64",
"65" = "65+"),
levels = c("0-14", "15-24", "25-34", "35-44",
"45-54", "55-64", "65+")))
raw<-read.csv("raw.csv")
head(raw)
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw<-read.csv("raw.csv")
head(raw)
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
library(tidyverse)
library(tidyr)
library(dplyr)
library(stringr)
df <- data.frame(row = LETTERS[1:3], a = 1:3, b = 4:6, c = 7:9)
df
df %>%
pivot_longer(cols = !row, names_to = "letters", values_to = "vals")
df %>%
pivot_longer( cols = c(a,b,c), names_to = "letters", values_to = "vals")
raw<-read.csv("raw.csv")
head(raw)
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
head(raw_longer)
raw_longer$sex <- str_sub(raw_longer$column, start = 1, end = 1)
head(raw_longer)
raw_longer <- raw_longer %>%
mutate(age = factor(recode(str_sub(raw_longer$column, start = 2),
"014" = "0-14",
"1524" = "15-24",
"2534" = "25-34",
"3544" = "35-44",
"4554" = "45-54",
"5564" = "55-64",
"65" = "65+"),
levels = c("0-14", "15-24", "25-34", "35-44",
"45-54", "55-64", "65+")))
head(raw_longer)
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer$sex <- str_sub(raw_longer$column, start = 1, end = 1)
raw_longer <- raw_longer %>%
mutate(age = factor(recode(str_sub(raw_longer$column, start = 2),
"014" = "0-14",
"1524" = "15-24",
"2534" = "25-34",
"3544" = "35-44",
"4554" = "45-54",
"5564" = "55-64",
"65" = "65+"),
levels = c("0-14", "15-24", "25-34", "35-44",
"45-54", "55-64", "65+")))
raw_longer <- raw_longer %>%
mutate(age = factor(recode(str_sub(raw_longer$column, start = 2),
"014" = "0-14",
"1524" = "15-24",
"2534" = "25-34",
"3544" = "35-44",
"4554" = "45-54",
"5564" = "55-64",
"65" = "65+"),
levels = c("0-14", "15-24", "25-34", "35-44",
"45-54", "55-64", "65+")))
raw_longer <- raw_longer %>%
mutate(age = factor(recode(str_sub(raw_longer$column, start = 2),
"014" = "0-14",
"1524" = "15-24",
"2534" = "25-34",
"3544" = "35-44",
"4554" = "45-54",
"5564" = "55-64",
"65" = "65+"),
levels = c("0-14", "15-24", "25-34", "35-44",
"45-54", "55-64", "65+")))
raw_longer$sex <- str_sub(raw_longer$column, start = 1, end = 1)
raw_longer$sex <- str_sub(raw_longer$column, start = 1, end = 1)
raw_longer$sex <- str_sub(raw_longer$column, start = 1, end = 1)
raw_longer$sex <- str_sub(raw_longer$column, start = 1, end = 1)
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
head(raw_longer)
raw_longer$sex <- str_sub(raw_longer$column, start = 1, end = 1)
head(raw_longer)
raw_longer <- raw_longer %>%
mutate(age = factor(recode(str_sub(raw_longer$column, start = 2),
"014" = "0-14",
"1524" = "15-24",
"2534" = "25-34",
"3544" = "35-44",
"4554" = "45-54",
"5564" = "55-64",
"65" = "65+"),
levels = c("0-14", "15-24", "25-34", "35-44",
"45-54", "55-64", "65+")))
head(raw_longer)
raw<-read.csv("raw.csv")
raw
raw_longer <- raw %>%
pivot_longer(cols = starts_with(c('m', 'f')),
names_to = "column",
values_to = "cases")
raw_longer
raw_longer$sex <- str_sub(raw_longer$column, start = 1, end = 1)
raw_longer
raw_longer <- raw_longer %>%
mutate(age = factor(recode(str_sub(raw_longer$column, start = 2),
"014" = "0-14",
"1524" = "15-24",
"2534" = "25-34",
"3544" = "35-44",
"4554" = "45-54",
"5564" = "55-64",
"65" = "65+"),
levels = c("0-14", "15-24", "25-34", "35-44",
"45-54", "55-64", "65+")))
raw_longer
shiny::runApp('C:/Users/barri/Documents/UFM/2024/Segundo Semestre/Data Product/Lab4_DataProduct/poke_api')
